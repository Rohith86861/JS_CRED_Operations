<!DOCTYPE html>
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href ="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
   
   <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
   <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
   <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<style>
    body{
        /*background-image:linear-gradient(to right, rgb(19, 132, 177) , rgb(64, 92, 145));*/

        background-color: aliceblue;
        
    }
    .container{
        background-image: blue;

    }
    .card{
       /* background-image: linear-gradient(to right, rgb(75, 174, 194) , rgb(157, 171, 199));*/
       background-image: linear-gradient(to right, rgb(132, 169, 226) , rgb(154, 202, 235));


    }
    .input-container{
	position:relative;
	margin-bottom:20px;
    left:10px;
    bottom:0px;
}
.input-container label{
	position:absolute;
	top:0px;
	left:0px;
	font-size:16px;
	color:#fff;	
	transition: all 0.5s ease-in-out;
}
.input-container input{ 
  border:0;
  border-bottom:1px solid #555;  
  background:transparent;
  width:70%;
  padding:8px 0 5px 0;
  font-size:16px;
  color:solid rgb(36, 106, 163);
}
.input-container input:focus{ 
 border:none;	
 outline:none;
 border-bottom:1px solid #29cc7a;	
}
.th{
    background-color: aquamarine;
}
       
</style>
</head>

<body>
    <div class="container" >
      <font size="6"
      color="blue">
      <center><h1><u>Students Data</u></h1></center>
    </font>





    <div class="card " id = "form1" style = "display:none; width: 110rem;">



    <form autocomplete="off" onsubmit="onFormSubmit()" >
        <center><h3>Student Information Form</h3></center>
        <div class="row d-flex justify-content-center align-items-center h-100" >
        
        <div class="col-2 form-group input-container">

            <input type="text" class="form-control-2" name="eid" id="eid" placeholder="Enter the student Id">
        </div> 
        <div class="col-4 form-group input-container w-40">

            <input type="text" class="form-control-2" name="ename" id="ename" placeholder="Enter the Student Name">
        </div>
        <div class="col-2 input-container ">
            <input type="text" class="form-control-2" name="dept" id="dept" placeholder="Enter the stream">
          </div>
         <!-- <div class="col-2 form-group input-container">

            <select class="form-control"  id="dept" name="dept" placeholder="Stream" width="">
            <option selected>Choose...</option>
              <option>CSE</option>
              <option>ECE</option>
              <option>EEE</option>
              <option>MECH</option>
            </select>
          </div>-->
        
        
        <div class="col-2 form-group input-container">
            <input type="text" class="form-control-2" name="mob" id="mob" placeholder="Enter Marks" maxlength="3">
        </div>

        <div class="col-3 form_action--button">
            <input type="submit" class="btn btn-success btn-lg" value="Submit">
            <input type="reset" class="btn btn-warning btn-lg" value="Reset">
        </div>

    </form>
</div>
</div>
<div class="row">
    <div class="col-8">
        <button class="btn btn-primary" id="add" type="submit" onclick="Openform()">Add</button>
        <button class="btn btn-danger" id="close" type="submit" onclick="Closeform()" style="display:none">Close</button>
    </div>


      <div class="col-4 input-container">

       Search <i class="fas fa-search"></i> :

       <input type="text" onkeyup="s1()" id="search" placeholder="Enter value to search">

    </div>
</div>
<button class="btn" style="color:black"id="filter" type="submit" onclick="Openfilter()"><i class="fas fa-filter fa-2x"></i>
</button>



<div class="row" id="filters" style = "display:none;">
    <div class="col-2 input-container">
      <i class="fas fa-filter"></i><input type="text" id="myInput" onkeyup="myFunction1()" placeholder="filter by employee Id" title="Type in a name">
</div>
<div class="col-4 input-container">
  <i class="fas fa-filter"></i><input type="text" id="myInput2" onkeyup="myFunction2()" placeholder="filter by employee name" title="Type in a name">
    </div>
    <div class="col-2 input-container">
      <i class="fas fa-filter"></i><input type="text" id="myInput3" onkeyup="myFunction3()" placeholder="filter by stream" title="Type in a name">
        </div>
        <div class="col-2 input-container">
          <i class="fas fa-filter"></i><input type="text" id="myInput4" onkeyup="myFunction4()" placeholder="filter by marks" title="Type in a name">
            </div>
            <div class="col-2">



              <button class="btn" id="closef" type="submit" onclick="Closefilter()" style="display:none">              <i class="fas fa-times-circle"></i></button>
            </div>

</div>




         <table class="list table table-striped" id="storeList">

                        <thead class="thead-dark" >

                            <tr style=" background-image: linear-gradient(to right, rgb(132, 169, 226) , rgb(154, 202, 235));
                            "> 
                                <th scope="col" >Employee Id <i onclick="sort1(1,'i',0)" class="fas fa-sort-numeric-down fa-2x"></i>
                                  <i onclick="sort1(0,'i',0)" class="fas fa-sort-numeric-up-alt fa-2x"></i>

                                </th>
                                <th scope="col" >Employee Name  <i onclick="sort1(1,'s',1)" class="fas fa-sort-alpha-down fa-2x"></i>
                                  <i onclick="sort1(0,'s',1)" class="fas fa-sort-alpha-up-alt fa-2x"></i>
</th>
                                <th scope="col">Department   <i onclick="sort1(1,'s',2)" class="fas fa-sort-alpha-down fa-2x"></i>
                                  <i onclick="sort1(0,'s',2)" class="fas fa-sort-alpha-up-alt fa-2x"></i>

                                </th>
                                <th scope="col">Marks  <i onclick="sort1(1,'i',3)" class="fas fa-sort-numeric-down fa-2x"></i>
                                  <i onclick="sort1(0,'i',3)" class="fas fa-sort-numeric-up-alt fa-2x"></i>

                                </th>
                                <th scope="col">Actions</th>

                            </tr>
                        </thead>
                        <tbody>

                        </tbody>
                    </table>
                </div>

                    <br>
                    <br>

                  <!---  <div>
                      <p>Json Data</p>
                   <p id="json"></p>
                   <p id="d1"></p>
                   <p id="d2"></p>
                   </div>-->


               
    <script>
            var list = [
			      /*{"eid":101, "ename":"emp1", "dept":"dept1","mob":1145267733},
            {eid:102, ename:"emp2", dept:"dept2",mob:2145267733},
            {eid:103, ename:"emp3", dept:"dept3",mob:1345267733},*/

		]; 
        var farr=[];
        //list.splice(4,1)
        var selectedRow = null;
        var f=0;
function onFormSubmit(){

    var va=valid()
    event.preventDefault();
    var formData = readFormData();

    if(selectedRow === null && va==true){
        insertNewRecord(formData);
       list.push(formData);
       /* document.getElementById("json").innerHTML = JSON.stringify(list);*/
    }
    else
    {
      if(va==true){
      list.push(formData);
      }
        /*list.splice(td.parentElement.parentElement.rowIndex,1);
*/
        updateRecord(formData);
    }
    resetForm();
    //document.getElementById("json").innerHTML = JSON.stringify(list);
}

function Openform()
{
//document.getElementById("form1").style.visibility = "visible";
document.getElementById("add").style.display = "none";
document.getElementById("close").style.display = "block";
document.getElementById('form1').style.display = '';
}
function Closeform()
{
//document.getElementById("form1").style.visibility = "visible";
document.getElementById("add").style.display = "block";
document.getElementById("close").style.display = "none";
document.getElementById('form1').style.display = "none";
}
function Openfilter()
{
//document.getElementById("form1").style.visibility = "visible";
document.getElementById("filter").style.display = "none";
document.getElementById("closef").style.display = "block";
document.getElementById('filters').style.display = '';
}
function Closefilter()
{
//document.getElementById("form1").style.visibility = "visible";
document.getElementById("filter").style.display = "block";
document.getElementById("closef").style.display = "none";
document.getElementById('filters').style.display = "none";
}



function buildTable(data){
		var table = document.getElementById('storeList')
    var table2 = document.getElementById("storeList").getElementsByTagName('tbody')[0];
    var newRow = table.insertRow(table2.length);
    var tr = table.getElementsByTagName("tr");
   /* for (var i = 1; i < data.length; i++){

    //row = td.parentElement.parentElement;
                     
        document.getElementById('storeList').deleteRow(i);
    }*/
    for(var j=1;j<data.length;j++){
    //tr[j].style.display = "none";
    //document.getElementById("storeList").deleteRow(j);
    tr[j].cells[0].innerHTML=data[j-1].eid;
    tr[j].cells[1].innerHTML=data[j-1].ename;
    tr[j].cells[2].innerHTML=data[j-1].dept;
    tr[j].cells[3].innerHTML=data[j-1].mob;
    }
   // document.getElementById("storeList").deleteRow(1);
    //if(f==1){
		/*for (var i = 0; i < data.length; i++){
			var row = `<tr>
							<td>${data[i].eid}</td>
							<td>${data[i].ename}</td>
							<td>${data[i].dept}</td>
              <td>${data[i].mob}</td>
              <td>${`<button onClick='onEdit(this)' class="btn btn-primary">Update</button> <button onClick='onDelete(this)' class="btn btn-danger">Delete</button>`}</td>

					  </tr>`
			table.innerHTML += row
          }
          

          for(var j=1;j<=data.length;j++){
    tr[j].style.display = "";
    //document.getElementById("storeList").deleteRow(j);
    }*/


		//}
   // f=0;
	}

function valid(){
    var eid=document.getElementById("eid").value;
        var ename=document.getElementById("ename").value;
        var dept=document.getElementById("dept").value;
        var mob=document.getElementById("mob").value;
        var regex = /^[a-zA-Z ]{2,30}$/;
    var ctrl =  document.getElementById("ename");
    var ctrl2 =  document.getElementById("dept");
        if (eid=="")
        {
            alert("id cannot be null");
            return false;
        }
        if (isNaN(eid))
        {
            alert("id should contain only integers");
            return false;
        }
        if(ename==""){
            alert(" name cannot be null");
            return false;
        }
        if(!(regex.test(ctrl.value))){
      alert("Invalid name"); 
      return false;
    }
    
        if(dept==""){
            alert("Stream cannot be null");
            return false;
        }

        if(!(regex.test(ctrl2.value))){
      alert("Invalid Stream"); 
      return false;
    }
        if(mob==""){
            alert("marks cannot be null");
            return false;
        }
        if(document.getElementById("mob").value > 100 || isNaN(mob)){
            alert("marks should be digits and less than or equal to 100");
            return false;
        }

        return true;
}
function myFunction1() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("storeList");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[0];
    if (td) {
        //alert("inside td");
      txtValue = td.textContent || td.innerText ;
     // if (txtValue.toUpperCase().indexOf(filter) > -1) {
        if (txtValue.substr(0, filter.length).toUpperCase()==filter) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
function sort1(n,t,r) {
  var input, filter, table, tr, td, td2,i, txtValue1,txtValue2,switching,shouldSwitch;
  switching = true;
  while (switching) {
    switching = false;
  table = document.getElementById("storeList");
  tr = table.getElementsByTagName("tr");
  for (i = 1; i < tr.length; i++) {
    shouldSwitch = false;
    td = tr[i].getElementsByTagName("td")[r];
    td2 = tr[i+1].getElementsByTagName("td")[r];

        txtValue1 = td.textContent || td.innerText ;
      txtValue2 = td2.textContent || td2.innerText ;
            if(t=="i"){
            if(n==0){
            if(Number(txtValue1)< Number(txtValue2)){

        shouldSwitch = true;
        break;
      }
    }
    else{
        if(Number(txtValue1)> Number(txtValue2)){

        shouldSwitch = true;
        break;
      } 

    }
}
else{
    if(n==0){
            if(txtValue1.toUpperCase()< txtValue2.toUpperCase()){

        shouldSwitch = true;
        break;
      }
    }
    else{
        if(txtValue1.toUpperCase()> txtValue2.toUpperCase()){
        shouldSwitch = true;
        break;
      } 

    }
}

    }//for
      if (shouldSwitch) {

      tr[i].parentNode.insertBefore(tr[i+1], tr[i]);
      switching = true;
    }
    }       
  }



function myFunction2() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput2");
  filter = input.value.toUpperCase();
  table = document.getElementById("storeList");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1];
    if (td) {
        //alert("inside td");
      txtValue = td.textContent || td.innerText ;
           // if (txtValue.toUpperCase().indexOf(filter) > -1) {
            if (txtValue.substr(0, filter.length).toUpperCase()==filter) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
function myFunction3() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput3");
  filter = input.value.toUpperCase();
  table = document.getElementById("storeList");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[2];
    if (td) {
        //alert("inside td");
      txtValue = td.textContent || td.innerText ;
     // if (txtValue.toUpperCase().indexOf(filter) > -1) {
        if (txtValue.substr(0, filter.length).toUpperCase()==filter) {

        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
function myFunction4() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput4");
  filter = input.value.toUpperCase();
  table = document.getElementById("storeList");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[3];
    if (td) {
        //alert("inside td");
      txtValue = td.textContent || td.innerText ;
     // if (txtValue.toUpperCase().indexOf(filter) > -1) {
        if (txtValue.substr(0, filter.length).toUpperCase()==filter) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
function s1() {
  var input, filter, table, tr, td1,td2,td3,td4, i, txtValue1,txtValue2,txtValue3,txtValue4;
  input = document.getElementById("search");
  filter = input.value.toUpperCase();
  table = document.getElementById("storeList");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td1 = tr[i].getElementsByTagName("td")[0];
    td2 = tr[i].getElementsByTagName("td")[1];
    td3 = tr[i].getElementsByTagName("td")[2];
    td4 = tr[i].getElementsByTagName("td")[3];
    if (td1 && td2 && td3 && td4) {
        //alert("inside td");
      txtValue1 = td1.textContent || td1.innerText ;
      txtValue2 = td2.textContent || td2.innerText ;
      txtValue3 = td3.textContent || td3.innerText ;
      txtValue4 = td4.textContent || td4.innerText ;
      if (txtValue1.toUpperCase().indexOf(filter) > -1 ||
      txtValue2.toUpperCase().indexOf(filter) > -1 ||
      txtValue3.toUpperCase().indexOf(filter) > -1 ||
      txtValue4.toUpperCase().indexOf(filter) > -1 
      ) {
       // if (txtValue.substr(0, filter.length).toUpperCase()==filter) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}


function readFormData(){
    

    
    var formData = {};
    formData["eid"] = document.getElementById("eid").value;
    formData["ename"] = document.getElementById("ename").value;
    formData["dept"] = document.getElementById("dept").value;
    formData["mob"] = document.getElementById("mob").value;
    //list.push(formData);
     //document.getElementById("json").innerHTML = JSON.stringify(list);

    return formData;
}

function insertNewRecord(data){
    
    var table = document.getElementById("storeList").getElementsByTagName('tbody')[0];
    var newRow = table.insertRow(table.length);
    var cell1 = newRow.insertCell(0);
        cell1.innerHTML = data.eid;
    var cell2 = newRow.insertCell(1);
        cell2.innerHTML = data.ename;
    var cell3 = newRow.insertCell(2);
        cell3.innerHTML = data.dept;
    var cell4 = newRow.insertCell(3);
        cell4.innerHTML = data.mob;
    var cell5 = newRow.insertCell(4);
        cell5.innerHTML = `<button onClick='onEdit(this)' class="btn btn-primary">Update</button> <button onClick='onDelete(this)' class="btn btn-danger">Delete</button>`
}

function onEdit(td){
  document.getElementById("add").style.display = "none";
  document.getElementById("close").style.display = "block";
  document.getElementById('form1').style.display = '';
    selectedRow = td.parentElement.parentElement;
    Rowu = td.parentElement.parentElement;
    document.getElementById('eid').value = selectedRow.cells[0].innerHTML;
    document.getElementById('ename').value = selectedRow.cells[1].innerHTML;
    document.getElementById('dept').value = selectedRow.cells[2].innerHTML;
    document.getElementById('mob').value = selectedRow.cells[3].innerHTML;
    //list.push(formData);
    list.splice(Rowu.rowIndex-1,1);
    
}

function updateRecord(formData){
    selectedRow.cells[0].innerHTML = formData.eid;
    selectedRow.cells[1].innerHTML = formData.ename;
    selectedRow.cells[2].innerHTML = formData.dept;
    selectedRow.cells[3].innerHTML = formData.mob;
    /*list[1].eid=formData.eid;
    list[1].ename=formData.ename;
    list[1].dept=formData.dept;
    list[1].mob=formData.mob;*/
    //alert("records update sucessfull");
   // document.getElementById("d2").innerHTML = JSON.stringify(list);
   selectedRow=null;
}

function onDelete(td){
    
        row = td.parentElement.parentElement;
        
                
        document.getElementById('storeList').deleteRow(row.rowIndex);
        
        list.splice(row.rowIndex,1);
      //  document.getElementById("d1").innerHTML = JSON.stringify(list);
        

    resetForm();
}

function resetForm(){
    document.getElementById('eid').value = '';
    document.getElementById('ename').value = '';
    document.getElementById('dept').value = '';
    document.getElementById('mob').value = '';
}

    </script>
</body>
</html>